@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);

  /* Elevation system */
  --color-background-elevated: var(--background-elevated);
  --color-background-overlay: var(--background-overlay);
  --color-surface-base: var(--background);
  --color-surface-elevated: var(--background-elevated);
  --color-surface-overlay: var(--background-overlay);

  /* Text hierarchy */
  --color-text-primary: var(--text-primary);
  --color-text-body: var(--text-body);
  --color-text-secondary: var(--text-secondary);
  --color-text-tertiary: var(--text-tertiary);
  --color-text-disabled: var(--text-disabled);

  /* Semantic colors */
  --color-success: var(--success);
  --color-success-foreground: var(--success-foreground);
  --color-success-bg: var(--success-bg);
  --color-success-border: var(--success-border);

  --color-warning: var(--warning);
  --color-warning-foreground: var(--warning-foreground);
  --color-warning-bg: var(--warning-bg);
  --color-warning-border: var(--warning-border);

  --color-error: var(--error);
  --color-error-foreground: var(--error-foreground);
  --color-error-bg: var(--error-bg);
  --color-error-border: var(--error-border);

  --color-info: var(--info);
  --color-info-foreground: var(--info-foreground);
  --color-info-bg: var(--info-bg);
  --color-info-border: var(--info-border);

  /* Gamification */
  --color-achievement-gold: var(--achievement-gold);
  --color-streak-orange: var(--streak-orange);
  --color-level-purple: var(--level-purple);

  /* Brand colors */
  --color-primary-hover: var(--primary-hover);
  --color-accent-hover: var(--accent-hover);
  --color-border-strong: var(--border-strong);

  /* Icon colors */
  --color-icon-primary: var(--icon-primary);
  --color-icon-accent: var(--icon-accent);
  --color-icon-muted: var(--icon-muted);
  --color-icon-interactive: var(--icon-interactive);

  /* Existing mappings */
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

:root {
  --radius: 0.625rem;

  /* Safe Area Insets for iOS notch/home indicator */
  --safe-area-top: env(safe-area-inset-top, 0);
  --safe-area-right: env(safe-area-inset-right, 0);
  --safe-area-bottom: env(safe-area-inset-bottom, 0);
  --safe-area-left: env(safe-area-inset-left, 0);

  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  /* === BACKGROUNDS - Elevation System === */
  --background: oklch(0.145 0 0);           /* #1a1a1a - Base surface */
  --background-elevated: oklch(0.18 0 0);   /* #232323 - Cards, panels */
  --background-overlay: oklch(0.22 0 0);    /* #2e2e2e - Modals, popovers */

  --foreground: oklch(0.985 0 0);
  --card: oklch(0.18 0 0);                  /* Updated to use elevated bg */
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.22 0 0);               /* Updated to use overlay bg */
  --popover-foreground: oklch(0.985 0 0);

  /* === TEXT HIERARCHY - Enhanced Contrast === */
  --text-primary: oklch(0.95 0 0);          /* #f2f2f2 - 16:1 - Headings */
  --text-body: oklch(0.88 0 0);             /* #e5e5e5 - 12:1 - Body text */
  --text-secondary: oklch(0.78 0 0);        /* #c9c9c9 - 8.5:1 - Secondary text */
  --text-tertiary: oklch(0.70 0 0);         /* #adadad - 6:1 - Tertiary text */
  --text-disabled: oklch(0.55 0 0);         /* #8a8a8a - 3.5:1 - Disabled text */

  /* === BRAND COLORS - Enhanced === */
  /* Primary color: Enhanced purple for better visibility */
  --primary: oklch(0.72 0.25 280);          /* Brighter purple - 7:1 contrast */
  --primary-foreground: oklch(1 0 0);
  --primary-hover: oklch(0.78 0.22 280);    /* Lighter on hover */

  /* Accent color: Enhanced cyan for better visibility */
  --accent: oklch(0.75 0.20 220);           /* Brighter cyan - 7:1 contrast */
  --accent-foreground: oklch(1 0 0);
  --accent-hover: oklch(0.82 0.18 220);     /* Lighter on hover */

  /* === ICON COLOR SYSTEM === */
  --icon-primary: oklch(0.88 0.20 280);     /* Bright purple for icons */
  --icon-accent: oklch(0.88 0.18 220);      /* Bright cyan for icons */
  --icon-muted: oklch(0.75 0 0);            /* Muted gray for secondary icons */
  --icon-interactive: oklch(0.92 0.15 280); /* Very bright for interactive */

  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.78 0 0);      /* Improved from 0.75 to 0.78 */

  /* === SEMANTIC COLORS - Educational Feedback === */
  --success: oklch(0.70 0.18 160);          /* #4ade80 - Green */
  --success-foreground: oklch(0.95 0.05 160);
  --success-bg: oklch(0.70 0.18 160 / 0.1); /* 10% opacity bg */
  --success-border: oklch(0.70 0.18 160 / 0.3); /* 30% opacity border */

  --warning: oklch(0.75 0.15 85);           /* #fbbf24 - Yellow/Orange */
  --warning-foreground: oklch(0.20 0.05 85);
  --warning-bg: oklch(0.75 0.15 85 / 0.1);
  --warning-border: oklch(0.75 0.15 85 / 0.3);

  --error: oklch(0.65 0.22 25);             /* #f87171 - Red */
  --error-foreground: oklch(0.95 0.05 25);
  --error-bg: oklch(0.65 0.22 25 / 0.1);
  --error-border: oklch(0.65 0.22 25 / 0.3);

  --info: oklch(0.65 0.20 240);             /* #60a5fa - Blue */
  --info-foreground: oklch(0.95 0.05 240);
  --info-bg: oklch(0.65 0.20 240 / 0.1);
  --info-border: oklch(0.65 0.20 240 / 0.3);

  /* === GAMIFICATION COLORS === */
  --achievement-gold: oklch(0.75 0.15 85);  /* Gold badges */
  --streak-orange: oklch(0.70 0.20 50);     /* Streak indicators */
  --level-purple: oklch(0.68 0.25 280);     /* Level up (same as primary) */

  /* === EXISTING (Updated) === */
  --destructive: oklch(0.65 0.22 25);       /* Same as error for consistency */
  --border: oklch(1 0 0 / 10%);             /* Subtle white border */
  --border-strong: oklch(1 0 0 / 20%);      /* More visible border */
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.68 0.25 280);             /* Focus ring (primary color) */

  /* Chart colors with improved visibility */
  --chart-1: oklch(0.68 0.25 280);          /* Primary purple */
  --chart-2: oklch(0.72 0.20 220);          /* Accent cyan */
  --chart-3: oklch(0.70 0.18 160);          /* Success green */
  --chart-4: oklch(0.70 0.20 50);           /* Streak orange */
  --chart-5: oklch(0.75 0.15 85);           /* Warning yellow */

  /* Sidebar */
  --sidebar: oklch(0.18 0 0);               /* Updated to elevated bg */
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.68 0.25 280);  /* Updated primary */
  --sidebar-primary-foreground: oklch(1 0 0);
  --sidebar-accent: oklch(0.22 0 0);        /* Updated to overlay bg */
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }

  body {
    @apply bg-background text-text-body;
    /* Improved readability settings */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;

    /* Safe area padding for iOS devices */
    padding-top: max(0px, var(--safe-area-top));
    padding-right: max(0px, var(--safe-area-right));
    padding-bottom: max(0px, var(--safe-area-bottom));
    padding-left: max(0px, var(--safe-area-left));
  }

  /* Typography scale with dark mode optimizations */
  h1, h2, h3, h4, h5, h6 {
    @apply text-text-primary font-semibold;
    letter-spacing: -0.015em;
  }

  h1 {
    @apply text-4xl leading-tight;
    line-height: 1.15;
  }

  h2 {
    @apply text-3xl leading-tight;
    line-height: 1.2;
  }

  h3 {
    @apply text-2xl leading-tight;
    line-height: 1.25;
  }

  h4 {
    @apply text-xl leading-snug;
  }

  h5 {
    @apply text-lg leading-snug;
  }

  h6 {
    @apply text-base leading-snug;
  }

  p {
    @apply text-text-body;
    line-height: 1.6;
    letter-spacing: 0.005em;
  }

  /* Enhanced focus states for keyboard navigation */
  button:focus-visible,
  a:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible,
  [role="button"]:focus-visible,
  [tabindex]:not([tabindex="-1"]):focus-visible {
    @apply outline-2 outline-offset-2 outline-primary ring-2 ring-primary/50;
  }

  /* Remove focus outline for mouse/touch interactions */
  button:focus:not(:focus-visible),
  a:focus:not(:focus-visible) {
    @apply outline-none;
  }

  /* Ensure backdrop is not focusable */
  [data-backdrop] {
    @apply pointer-events-auto;
  }
}

/* Custom Animations */
@keyframes blob {
  0% {
    transform: translate(0px, 0px) scale(1);
  }
  33% {
    transform: translate(30px, -50px) scale(1.1);
  }
  66% {
    transform: translate(-20px, 20px) scale(0.9);
  }
  100% {
    transform: translate(0px, 0px) scale(1);
  }
}

.animate-blob {
  animation: blob 7s infinite;
}

.animation-delay-2000 {
  animation-delay: 2s;
}

.animation-delay-4000 {
  animation-delay: 4s;
}

/* Smooth scrolling with reduced motion support */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
}

/* === iOS AUTO-ZOOM PREVENTION === */
/* Prevent iOS Safari from zooming in on input focus by ensuring 16px minimum font-size */
@media (hover: none) and (pointer: coarse) {
  input,
  select,
  textarea {
    font-size: max(16px, 1em) !important;
  }
}

/* Custom scrollbar - Light theme */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: oklch(0.96 0 0); /* Light gray */
}

::-webkit-scrollbar-thumb {
  background: oklch(0.75 0 0); /* Medium gray */
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: oklch(0.60 0 0); /* Darker gray on hover */
}

/* ============================================= */
/* MODERN UTILITY CLASSES - 2024/2025 */
/* ============================================= */

@layer utilities {
  /* === GRADIENT UTILITIES === */

  /* Aurora gradient - Modern flowing gradient */
  .gradient-aurora {
    background: linear-gradient(
      135deg,
      oklch(0.68 0.25 280) 0%,
      oklch(0.70 0.23 260) 35%,
      oklch(0.72 0.20 220) 70%,
      oklch(0.70 0.22 200) 100%
    );
  }

  /* Mesh gradient - Multiple radial gradients */
  .gradient-mesh {
    background:
      radial-gradient(at 20% 30%, oklch(0.68 0.25 280 / 0.3) 0px, transparent 50%),
      radial-gradient(at 80% 20%, oklch(0.72 0.20 220 / 0.3) 0px, transparent 50%),
      radial-gradient(at 40% 80%, oklch(0.70 0.22 200 / 0.3) 0px, transparent 50%);
  }

  /* Mesh gradient - Stronger version for hero sections */
  .gradient-mesh-strong {
    background:
      radial-gradient(at 20% 30%, oklch(0.68 0.25 280 / 0.4) 0px, transparent 50%),
      radial-gradient(at 80% 20%, oklch(0.72 0.20 220 / 0.4) 0px, transparent 50%),
      radial-gradient(at 40% 80%, oklch(0.70 0.18 160 / 0.3) 0px, transparent 50%);
  }

  /* Gradient text effect */
  .text-gradient {
    @apply bg-clip-text text-transparent;
    background-image: linear-gradient(
      90deg,
      var(--primary),
      var(--accent)
    );
  }

  /* Gradient text - Aurora variant */
  .text-gradient-aurora {
    @apply bg-clip-text text-transparent;
    background-image: linear-gradient(
      135deg,
      oklch(0.68 0.25 280),
      oklch(0.72 0.20 220),
      oklch(0.70 0.18 160)
    );
  }

  /* === GLASSMORPHISM EFFECTS - Mobile-First Performance === */

  .glass {
    /* Mobile: No blur for better performance */
    @apply bg-white/90 border border-gray-200;
  }

  @media (min-width: 768px) {
    .glass {
      /* Desktop: Moderate blur */
      @apply bg-white/80 backdrop-blur-sm border border-gray-200;
    }
  }

  .glass-strong {
    /* Mobile: Solid background */
    @apply bg-white/95 border border-gray-300;
  }

  @media (min-width: 768px) {
    .glass-strong {
      /* Desktop: Strong blur */
      @apply bg-white/90 backdrop-blur-md border border-gray-300;
    }
  }

  .glass-card {
    /* Mobile-first approach */
    @apply bg-gradient-to-br from-white to-gray-50 border border-gray-200;
  }

  @media (min-width: 768px) {
    .glass-card {
      /* Desktop only blur */
      @apply bg-gradient-to-br from-white/80 to-gray-50/80 backdrop-blur-sm border border-gray-200;
    }
  }

  /* === TEXT UTILITIES === */

  .text-heading {
    @apply text-text-primary;
  }

  .text-body {
    @apply text-text-body;
  }

  .text-secondary {
    @apply text-text-secondary;
  }

  .text-tertiary {
    @apply text-text-tertiary;
  }

  .text-disabled {
    @apply text-text-disabled;
  }

  /* === SURFACE UTILITIES === */

  .surface-base {
    @apply bg-background;
  }

  .surface-elevated {
    @apply bg-surface-elevated;
  }

  .surface-overlay {
    @apply bg-surface-overlay;
  }

  /* === GLOW EFFECTS === */

  .glow-primary {
    box-shadow: 0 0 20px oklch(0.68 0.25 280 / 0.3);
  }

  .glow-accent {
    box-shadow: 0 0 20px oklch(0.72 0.20 220 / 0.3);
  }

  .glow-success {
    box-shadow: 0 0 20px oklch(0.70 0.18 160 / 0.3);
  }

  /* === HOVER EFFECTS === */

  .hover-lift {
    @apply transition-all duration-300;
  }

  .hover-lift:hover {
    @apply -translate-y-1 shadow-lg;
  }

  .hover-glow:hover {
    @apply shadow-[0_0_20px_oklch(0.68_0.25_280_/_0.4)];
  }

  /* === BADGE UTILITIES === */

  .badge-success {
    @apply bg-success-bg border border-success-border text-success;
  }

  .badge-warning {
    @apply bg-warning-bg border border-warning-border text-warning;
  }

  .badge-error {
    @apply bg-error-bg border border-error-border text-error;
  }

  .badge-info {
    @apply bg-info-bg border border-info-border text-info;
  }

  /* === CARD ELEVATION SHADOWS === */

  .shadow-elevated {
    box-shadow: 0 2px 8px oklch(0 0 0 / 0.2);
  }

  .shadow-overlay {
    box-shadow: 0 8px 24px oklch(0 0 0 / 0.3);
  }

  /* === BORDER UTILITIES === */

  .border-strong {
    @apply border-border-strong;
  }

  /* === ANIMATION UTILITIES === */

  .animate-glow {
    animation: glow 2s ease-in-out infinite;
  }

  @keyframes glow {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  /* === RESPONSIVE TEXT SIZES === */

  .text-responsive-xl {
    @apply text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl;
  }

  .text-responsive-lg {
    @apply text-xl sm:text-2xl md:text-3xl lg:text-4xl;
  }

  .text-responsive-md {
    @apply text-lg sm:text-xl md:text-2xl;
  }

  /* === MODERN VIEWPORT UNITS === */

  /* Dynamic viewport height - adjusts when mobile keyboard appears */
  .h-screen-mobile {
    height: 100dvh;
  }

  /* Small viewport height - smallest possible viewport (keyboard visible) */
  .min-h-screen-mobile {
    min-height: 100svh;
  }

  /* Large viewport height - largest possible viewport (no browser UI) */
  .h-screen-large {
    height: 100lvh;
  }

  /* Fallback support for older browsers */
  @supports not (height: 100dvh) {
    .h-screen-mobile {
      height: 100vh;
    }
    .min-h-screen-mobile {
      min-height: 100vh;
    }
    .h-screen-large {
      height: 100vh;
    }
  }

  /* === SAFE AREA UTILITIES === */

  /* Individual safe area padding utilities */
  .pt-safe {
    padding-top: max(1rem, var(--safe-area-top));
  }

  .pr-safe {
    padding-right: max(1rem, var(--safe-area-right));
  }

  .pb-safe {
    padding-bottom: max(1rem, var(--safe-area-bottom));
  }

  .pl-safe {
    padding-left: max(1rem, var(--safe-area-left));
  }

  /* Combined safe area padding */
  .px-safe {
    padding-left: max(1rem, var(--safe-area-left));
    padding-right: max(1rem, var(--safe-area-right));
  }

  .py-safe {
    padding-top: max(1rem, var(--safe-area-top));
    padding-bottom: max(1rem, var(--safe-area-bottom));
  }

  /* Safe area margins */
  .mt-safe {
    margin-top: max(1rem, var(--safe-area-top));
  }

  .mb-safe {
    margin-bottom: max(1rem, var(--safe-area-bottom));
  }

  /* === TOUCH TARGET UTILITIES - WCAG 2.2 Compliant === */

  /* Level AA: 24px minimum */
  .touch-target-aa {
    @apply min-w-[24px] min-h-[24px] inline-flex items-center justify-center;
  }

  /* Level AAA: 44px desktop, 48px mobile (recommended) */
  .touch-target {
    @apply min-w-[44px] min-h-[44px] inline-flex items-center justify-center;
  }

  /* Large touch target: 48px (Material Design + iOS compliant) */
  .touch-target-lg {
    @apply min-w-[48px] min-h-[48px] inline-flex items-center justify-center;
  }

  /* Responsive: 48px mobile, 44px desktop */
  .touch-target-mobile {
    @apply min-w-[48px] min-h-[48px] md:min-w-[44px] md:min-h-[44px] inline-flex items-center justify-center;
  }

  /* Hitbox expansion without affecting layout (invisible pseudo-element) */
  .touch-target-hitbox {
    @apply relative;
  }

  .touch-target-hitbox::before {
    content: '';
    @apply absolute -inset-3;
  }

  /* Minimum tap spacing between adjacent targets (WCAG 2.5.8) */
  .touch-spacing {
    @apply gap-2; /* 8px minimum spacing */
  }

  .touch-spacing-lg {
    @apply gap-4; /* 16px comfortable spacing */
  }
}
